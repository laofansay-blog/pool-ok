<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>快速选择按钮调试</title>
    <link rel="stylesheet" href="styles/main.css">
    <style>
        body { padding: 20px; background: #2c1810; }
        .debug-section { 
            background: rgba(0,0,0,0.3); 
            padding: 20px; 
            margin: 20px 0; 
            border-radius: 8px;
            border: 1px solid #d4af37;
        }
        .debug-title { 
            color: #d4af37; 
            margin-bottom: 15px; 
            font-family: 'Cinzel', serif;
        }
        .test-group {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid #444;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1 style="color: #d4af37; text-align: center;">快速选择按钮调试页面</h1>
    
    <div class="debug-section">
        <h2 class="debug-title">1. 静态HTML测试</h2>
        <div class="test-group">
            <div class="group-header">
                <span class="group-name">测试组</span>
                <div class="quick-select">
                    <button class="quick-btn" data-action="all" data-group="1">全</button>
                    <button class="quick-btn" data-action="big" data-group="1">大</button>
                    <button class="quick-btn" data-action="small" data-group="1">小</button>
                    <button class="quick-btn" data-action="odd" data-group="1">单</button>
                    <button class="quick-btn" data-action="even" data-group="1">双</button>
                    <button class="quick-btn" data-action="clear" data-group="1">清</button>
                </div>
            </div>
            <div class="group-numbers">
                <div class="number-circle" data-number="1" data-group="1">1</div>
                <div class="number-circle" data-number="2" data-group="1">2</div>
                <div class="number-circle" data-number="3" data-group="1">3</div>
                <div class="number-circle" data-number="4" data-group="1">4</div>
                <div class="number-circle" data-number="5" data-group="1">5</div>
                <div class="number-circle" data-number="6" data-group="1">6</div>
                <div class="number-circle" data-number="7" data-group="1">7</div>
                <div class="number-circle" data-number="8" data-group="1">8</div>
                <div class="number-circle" data-number="9" data-group="1">9</div>
                <div class="number-circle" data-number="10" data-group="1">10</div>
            </div>
        </div>
    </div>
    
    <div class="debug-section">
        <h2 class="debug-title">2. JavaScript生成测试</h2>
        <div id="jsGeneratedGroup"></div>
        <button onclick="generateTestGroup()" style="background: #d4af37; color: #2c1810; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer;">生成测试组</button>
    </div>
    
    <div class="debug-section">
        <h2 class="debug-title">3. 调试信息</h2>
        <div id="debugInfo" style="color: #fff; font-family: monospace; white-space: pre-wrap;"></div>
    </div>

    <script>
        let selectedNumbers = []
        
        function generateTestGroup() {
            const container = document.getElementById('jsGeneratedGroup')
            container.innerHTML = ''
            
            const groupDiv = document.createElement('div')
            groupDiv.className = 'test-group'
            groupDiv.setAttribute('data-group', '2')
            
            // 组头部
            const groupHeader = document.createElement('div')
            groupHeader.className = 'group-header'
            groupHeader.innerHTML = `
                <span class="group-name">JavaScript生成组</span>
                <div class="quick-select">
                    <button class="quick-btn" data-action="all" data-group="2">全</button>
                    <button class="quick-btn" data-action="big" data-group="2">大</button>
                    <button class="quick-btn" data-action="small" data-group="2">小</button>
                    <button class="quick-btn" data-action="odd" data-group="2">单</button>
                    <button class="quick-btn" data-action="even" data-group="2">双</button>
                    <button class="quick-btn" data-action="clear" data-group="2">清</button>
                </div>
            `
            
            // 数字容器
            const numbersDiv = document.createElement('div')
            numbersDiv.className = 'group-numbers'
            
            // 创建1-10的数字圆圈
            for (let num = 1; num <= 10; num++) {
                const circle = document.createElement('div')
                circle.className = 'number-circle'
                circle.setAttribute('data-number', num)
                circle.setAttribute('data-group', '2')
                circle.textContent = num
                circle.onclick = () => toggleNumber(num, 2, circle)
                numbersDiv.appendChild(circle)
            }
            
            groupDiv.appendChild(groupHeader)
            groupDiv.appendChild(numbersDiv)
            container.appendChild(groupDiv)
            
            // 绑定快速选择按钮事件
            initializeQuickSelectButtons()
            
            updateDebugInfo()
        }
        
        function initializeQuickSelectButtons() {
            const buttons = document.querySelectorAll('.quick-btn')
            console.log('找到快速选择按钮数量:', buttons.length)
            
            buttons.forEach((btn, index) => {
                console.log(`按钮 ${index}:`, btn.textContent, btn.getAttribute('data-action'), btn.getAttribute('data-group'))
                
                // 移除旧的事件监听器
                btn.removeEventListener('click', handleQuickSelectClick)
                // 添加新的事件监听器
                btn.addEventListener('click', handleQuickSelectClick)
            })
        }
        
        function handleQuickSelectClick(e) {
            e.preventDefault()
            console.log('快速选择按钮被点击:', e.target.textContent)
            
            const action = this.getAttribute('data-action')
            const group = parseInt(this.getAttribute('data-group'))
            
            console.log('执行操作:', action, '组:', group)
            handleQuickSelect(action, group)
        }
        
        function handleQuickSelect(action, group) {
            console.log(`处理快速选择: ${action}, 组: ${group}`)
            
            const groupElement = document.querySelector(`[data-group="${group}"]`)
            if (!groupElement) {
                console.error('未找到组元素:', group)
                return
            }
            
            const numbers = groupElement.querySelectorAll('.number-circle')
            console.log('找到数字圆圈数量:', numbers.length)
            
            switch (action) {
                case 'all':
                    numbers.forEach(circle => {
                        const selection = `${group}-${circle.getAttribute('data-number')}`
                        if (!selectedNumbers.includes(selection)) {
                            selectedNumbers.push(selection)
                            circle.classList.add('selected')
                        }
                    })
                    break
                    
                case 'big':
                    numbers.forEach(circle => {
                        const number = parseInt(circle.getAttribute('data-number'))
                        const selection = `${group}-${number}`
                        if (number >= 6 && number <= 10) {
                            if (!selectedNumbers.includes(selection)) {
                                selectedNumbers.push(selection)
                                circle.classList.add('selected')
                            }
                        }
                    })
                    break
                    
                case 'small':
                    numbers.forEach(circle => {
                        const number = parseInt(circle.getAttribute('data-number'))
                        const selection = `${group}-${number}`
                        if (number >= 1 && number <= 5) {
                            if (!selectedNumbers.includes(selection)) {
                                selectedNumbers.push(selection)
                                circle.classList.add('selected')
                            }
                        }
                    })
                    break
                    
                case 'odd':
                    numbers.forEach(circle => {
                        const number = parseInt(circle.getAttribute('data-number'))
                        const selection = `${group}-${number}`
                        if (number % 2 === 1) {
                            if (!selectedNumbers.includes(selection)) {
                                selectedNumbers.push(selection)
                                circle.classList.add('selected')
                            }
                        }
                    })
                    break
                    
                case 'even':
                    numbers.forEach(circle => {
                        const number = parseInt(circle.getAttribute('data-number'))
                        const selection = `${group}-${number}`
                        if (number % 2 === 0) {
                            if (!selectedNumbers.includes(selection)) {
                                selectedNumbers.push(selection)
                                circle.classList.add('selected')
                            }
                        }
                    })
                    break
                    
                case 'clear':
                    numbers.forEach(circle => {
                        const number = parseInt(circle.getAttribute('data-number'))
                        const selection = `${group}-${number}`
                        const index = selectedNumbers.indexOf(selection)
                        if (index > -1) {
                            selectedNumbers.splice(index, 1)
                            circle.classList.remove('selected')
                        }
                    })
                    break
            }
            
            updateDebugInfo()
        }
        
        function toggleNumber(number, group, circle) {
            const selection = `${group}-${number}`
            
            if (selectedNumbers.includes(selection)) {
                selectedNumbers = selectedNumbers.filter(n => n !== selection)
                circle.classList.remove('selected')
            } else {
                selectedNumbers.push(selection)
                circle.classList.add('selected')
            }
            
            updateDebugInfo()
        }
        
        function updateDebugInfo() {
            const debugInfo = document.getElementById('debugInfo')
            debugInfo.textContent = `
已选择的数字: ${selectedNumbers.join(', ')}
快速选择按钮数量: ${document.querySelectorAll('.quick-btn').length}
数字圆圈数量: ${document.querySelectorAll('.number-circle').length}
            `
        }
        
        // 页面加载时初始化
        window.addEventListener('load', () => {
            initializeQuickSelectButtons()
            updateDebugInfo()
        })
    </script>
</body>
</html>
